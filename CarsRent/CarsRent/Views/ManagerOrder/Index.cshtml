@model IEnumerable<CarsRent.Models.Order>

@{
    ViewBag.Title = "Index";
}
<div class="body-content" style="margin-top:20px">
    <div class="header-a" style="margin-left:-20px">
        <header>
            <ul class="nav nav-pills" style="background-color:lightgrey">
                <li class="active" id="nav_name"><a>全部订单</a></li>&nbsp;
                <li id="nav_name"><a class="checkByPay" data-id="0">待付款</a></li>&nbsp;
                <li id="nav_name"><a class="checkByPay" data-id="1">已付款</a></li>&nbsp;
                <li id="nav_name"><a class="checkByStatus" data-id="1">正在使用</a></li>&nbsp;
                <li id="nav_name"><a class="checkByStatus" data-id="2">已完成</a></li>&nbsp;
                <li id="nav_name"><a class="checkByPay" data-id="2">已取消</a></li>
            </ul>
        </header>

    </div>
    <div>
        <br />
    </div>
    <div class="panel panel-default">
        <div class="panel-heading">
            <h4>Order Table</h4>
        </div>
        <div class="panel-body">

            <div style="float:right;background:#f6f6f6">
                <div class="container-fluid">
                    <div class="navbar-header">
                        <span class="navbar-brand" href="#">订单查找:</span>
                    </div>
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input type="text" id="order_info" class="form-control" placeholder="请输入用户名">
                        </div>
                        <a id="btn-search" class="btn btn-default"><span class="glyphicon glyphicon-search"></span></a>
                    </form>
                </div>
            </div>
            <div id="order_list">
                @{Html.RenderAction("OrderList", "ManagerOrder");}
            </div>
        </div>
    </div>
</div>


        @section Scripts {
            <link rel="stylesheet" href="~/Content/MyStyle.css" />
            <link href="~/Content/bootstrap.css" type="text/css" rel="stylesheet" />
            <script src="~/Scripts/bootbox.js" type="text/javascript"></script>
            <script type="text/javascript">
                $(document).ready(function () {
                    $(".delete").click(function () {
                        var recordID = $(this).attr("data-id");
                        bootbox.dialog({
                            size: "small",
                            onEscape: "true",
                            message: "你确定要删除该订单吗?",
                            title: "操作确认",
                            buttons: {
                                OK: {
                                    label: " 确定 ",
                                    className: "btn btn-myStyle",
                                    callback: function () {
                                        $.post("/ManagerOrder/Delete",
                                        { recordID: recordID },
                                        function (data) {
                                            if (data.Status == 1) {
                                                //window.location.reload();
                                                $("#record_" + recordID).fadeOut();
                                                alert("删除成功！");
                                            }
                                            else {
                                                alert("操作发生异常,删除失败！");
                                            }
                                        });
                                    }
                                },
                                Cancel: {
                                    label: " 取消 ",
                                    className: "btn btn-default",
                                    callback: function () {
                                    }
                                }
                            }
                        });
                    });

                    $('ul.nav').delegate("li", "click", function () {
                        $("li").removeClass('active');
                        $(this).addClass('active');
                    });
                    $("#btn-search").click(function () {
                        var orderInfo = $("#order_info").val();
                        $.ajax({
                            type: "POST",
                            url: "/ManagerOrder/OrderList",
                            data: { OrderInfo: orderInfo},
                            datatype: "json",
                            success: function (date) {
                                $("#order_list").html(date);
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                alert(errorThrown);
                            }
                        })
                    })
                    $(".checkByPay").click(function () {
                        var PayYesNo = $(this).attr("data-id");
                        $.ajax({
                            type: "POST",
                            url: "/ManagerOrder/OrderCategory",
                            data: { Pay: PayYesNo },
                            datatype: "json",
                            success: function (date) {
                                $("#order_list").html(date);
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                alert(errorThrown);
                            }
                        })
                    })
                    $(".checkByStatus").click(function () {
                        var carStatus = $(this).attr("data-id");
                        $.ajax({
                            type: "POST",
                            url: "/ManagerOrder/OrderCategory",
                            data: { CarStatus:carStatus },
                            datatype: "json",
                            success: function (date) {
                                $("#order_list").html(date);
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) {
                                alert(errorThrown);
                            }
                        })
                    })
                });
                //$(document).on("click","")
            </script>
        }
