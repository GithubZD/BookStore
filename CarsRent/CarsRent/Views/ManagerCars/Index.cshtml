@model IEnumerable<CarsRent.Models.Car>
@using X.PagedList.Mvc
@using X.PagedList

@{
    ViewBag.Title = "Index";
}

<div>
    <h4>
        @Html.ActionLink("添加新车", "Create", "ManagerCars")
    </h4>

</div>
<div>
    <table class="table">
        <thead>
            <tr>
                <th>
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.CarName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.PlateNumber)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.RentPrice)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Number)
                </th>
                <th></th>
            </tr>
        </thead>

        <tbody>
            @foreach (var item in Model)
            {
                <tr id="record_@item.CarId">
                    <td>
                        <img src="@item.ImageUrl" alt="270*170" />
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.CarName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.PlateNumber)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.RentPrice)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Number)
                    </td>
                    <td>
                        @Html.ActionLink("编辑", "Edit", new { id = item.CarId }) |
                        @Html.ActionLink("详细资料", "Details", new { id = item.CarId }) |
                        <a class="delete" data-id="@item.CarId">删除</a>
                    </td>
                </tr>
            }
        </tbody>


    </table>
</div>
@Html.PagedListPager((IPagedList)Model, p => Url.Action("Index", new { page = p }))


@section Scripts {
    <link rel="stylesheet" href="~/Content/MyStyle.css" />
    <script src="~/Scripts/bootbox.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $(".delete").click(function () {
                var recordID = $(this).attr("data-id");
                    bootbox.dialog({
                        size: "small",
                        onEscape: "true",
                        message: "你确定要删除吗?",
                        title: "操作确认",
                        buttons: {
                            OK: {
                                label: " 确定 ",
                                className: "red-haze fa fa-check btn-myStyle ",
                                callback: function () {
                                    $.post("/ManagerCars/Delete",
                                    { recordID: recordID },
                                    function (data) {
                                        if (data.Status==1) {
                                            $("#record_" + recordID).fadeOut();
                                            alert("删除成功！");
                                        }
                                        else {
                                            alert("操作发生异常,删除失败！");
                                        }
                                    });
                                }
                            },
                            Cancel: {
                                label: " 取消 ",
                                className: "green-jungle fa fa-times btn btn-default",
                                callback: function () {
                                }
                            }
                        }
                    });
            });
        });
    </script>
}